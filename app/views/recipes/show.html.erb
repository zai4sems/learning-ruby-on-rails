<%- model_class = Recipe -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.titleize %></h1>
</div>

<dl class="dl-horizontal">
  <dd><%= image_tag(@recipe.image.url, size: "250x150") if @recipe.image? %></dd>
  <dt><strong><%= model_class.human_attribute_name(:title) %>:</strong></dt>
  <dd><%= @recipe.title %></dd>
  <dt><strong><%= model_class.human_attribute_name(:description) %>:</strong></dt>
  <dd><%= @recipe.description %></dd>
  

    <hr>
<div class="container">
  <h2>Ingredients</h2>
  <div class="row">
    <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#viewingredient">
      View All Ingredients
    </button>
    
  </div>
  

  
  <!-- Modal -->
      
        <div class="modal fade" id="viewingredient" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="myModalLabel">Add new Ingredient</h4>
            </div>
            <div class="modal-body">
              <div class="field">
                <table class="table table-striped" id="ingredients_list">
                  <thead>
                  <tr>
                      <th>Ingredient Name</th>
                      <th>Purchase price</th>
                      <th>Purchase weight or volume</th>
                      <th>Unit</th>
                      <th>Price per single unit</th>
                      <th>Action</th>
                  </tr>
                  </thead>
                  <tbody id="container_ingredients_list">
                      <%= render 'ingredient_list', f: @ingredients, g: @recipe %>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal" id="viewingredientclose">Close</button>
            </div>
          </div>
        </div>
      </div>
    <!-- Modal -->

    
    
    <table class="table table-striped">
    <thead>
    <tr>
        <th>Ingredient Name</th>
        <th>Unit</th>
        <th>Quantity</th>
        <th>Cost to buy ingredients</th>
    </tr>
    </thead>
    <tbody id="container_recipe_ingredient">
        <%= render 'ing', f: @recipe %>
        <tr>
          <td colspan="3" align="right"><strong>Total ingredients cost</strong></td>
          <td colspan="1"><strong><%= number_to_currency(@recipe.cost, :unit => "RM") %></strong>   <input type="button" value="Update" class="btn btn-info btn-xs" onClick="window.location.reload()"></td>
        </tr>
    </tbody>
    </table>
    
</div>
    
    
    
 <h3>Summary</h3>   
  <div class="row">
    <div class="col-md-3"><strong>Rate Per Hour:</strong></div>
    <div class="col-md-1 text-right"><%= number_to_currency(@recipe.rate_per_hour, :unit => "RM") %></div>
  </div>
  <div class="row">
    <div class="col-md-3"><strong>Time spent in hour:</strong></div>
    <div class="col-md-1 text-right"><%= @recipe.time_spent_in_hour %></div>
  </div>
  <div class="row">
    <div class="col-md-3"><strong>Overhead Cost Per Hour:</strong></div>
    <div class="col-md-1 text-right"><%= number_to_currency(current_user.overheads.sum(:total)/((52-current_user.no_of_week_holiday_per_year.to_f)*current_user.hour_worked_per_week.to_f), :unit => "RM") %></div>
    <div class="col-md-6 text-right"><strong>Labour Cost:</strong></div>
    <div class="col-md-1 text-right"><%= number_to_currency(@labour, :unit => "RM") %></div>
  </div>
    <div class="row"><br>
    <div class="col-md-3"><strong>Percentage profit to add:</strong></div>
    <div class="col-md-1 text-right"><%= number_to_percentage(@recipe.percentage_profit) %></div>
    <div class="col-md-6 text-right"><strong>Profit to add to price:</strong></div>
    <div class="col-md-1 text-right"><%= number_to_currency(@profit, :unit => "RM") %></div>
  </div>
  <br>
  <div class="row">
    <div class="col-md-10 text-right"><strong>Ingredients Cost:</strong></div>
    <div class="col-md-1 text-right"><%= number_to_currency(@recipe.cost, :unit => "RM") %></div>
  </div>
  <div class="row">
    <div class="col-md-10 text-right"><strong>Total Cost of CAKE(S):</strong></div>
    <div class="col-md-1 text-right"><%= number_to_currency(@cake_cost, :unit => "RM") %></div>
  </div>
  <div class="row">
    <div class="col-md-10 text-right"><strong>TOTAL cost of cake including profit:</strong></div>
    <div class="col-md-1 text-right"><strong><%= number_to_currency(@total, :unit => "RM") %></strong></div>
  </div>




<%= link_to t('.back', :default => t("helpers.links.back")),
              my_recipes_path, :class => 'btn btn-default'  %>
<%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_recipe_path(@recipe), :class => 'btn btn-default' %>
<%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              recipe_path(@recipe),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>