<%- model_class = Recipe -%>

<div class="page-header">
  <h1>Recipes <%= link_to 'New', new_recipe_path, :class => 'btn btn-primary' %></h1>
</div>
<%= link_to raw("<i class=\"fa fa-th\" aria-hidden=\"true\"> Grid</i>"), 
          my_recipes_path, 
          class: "btn btn-default" %>
<br>
<br>

<div align="center">
    <%#= will_paginate %>
</div>
    <table class="table table-striped" id="recipes_list">
      <thead>
        <tr>
          <th><%= model_class.human_attribute_name(:title) %></th>
          <th><%= model_class.human_attribute_name(:image) %></th>
          <th>Ingredients Cost</th>
          <th>Non-food item cost (Materials)</th>
          <th>Grant cost of Recipe</th>
          <th>Number of Servings</th>
          <th>Grant Cost Per Serving</th>
          <th><%=t '.actions', :default => t("helpers.actions") %></th>
        </tr>
      </thead>
      <tbody>
        <% @recipes.each do |recipe| %>
          <tr>
            <% @recipe = Recipe.includes(:recipe_ingredients).find(recipe.id) %>
            <% @recipe.calculate_cost %>
            <% @recipe.calculate_material_cost %>
            <td><%= link_to recipe.title, recipe_path(recipe) %></td>
            <td><%= image_tag recipe.image.url, size: "100x100" %></td>
            <td><%= number_to_currency(@recipe.cost, :unit => "RM") %></td>
            <td><%= number_to_currency(@recipe.material_cost, :unit => "RM") %></td>
            <td><%= number_to_currency(@recipe.cost.to_f + @recipe.material_cost.to_f, :unit => "RM") %></td>
            <td><%= @recipe.serving_number %></td>
            <td><%= number_to_currency((@recipe.cost.to_f + @recipe.material_cost.to_f) / @recipe.serving_number.to_i, :unit => "RM") %></td>
            <td>
                    
              <%= link_to '', edit_recipe_path(recipe), :class => 'btn btn-default btn-xs fa fa-pencil-square-o'%>
              <%= link_to '', recipe_path(recipe), method: :delete, data: {confirm: "Are you sure?"}, :class => 'btn btn-xs btn-danger fa fa-trash' %>
              
              <%#= link_to t('.destroy', :default => t("helpers.links.destroy")),
                          recipe_path(recipe),
                          :method => :delete,
                          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                          :class => 'btn btn-xs btn-danger' %>
            </td>
          </tr>
    
        <% end %>
      </tbody>
    </table>
<div align="center">
    <%#= will_paginate %>
</div>





